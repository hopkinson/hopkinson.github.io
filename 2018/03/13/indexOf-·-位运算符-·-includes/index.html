<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="hopkinson"><meta name="description" content="广州·前端"><link rel="alternative" href="/atom.xml" title="何大小成" type="application/atom+xml"><link rel="icon" href="/logo.png"><title>indexOf · 位运算符 · includes - 何大小成</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="/">何大小成</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">唱遊→</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2018-03-13T08:52:22.000Z">March 13, 2018</time><h1 class="post__title"><a href="/2018/03/13/indexOf-·-位运算符-·-includes/">indexOf · 位运算符 · includes</a></h1><div class="post__main echo"><p>检测某元素是否在数组里，据我所知有三种方法：</p>
<ol>
<li>indexOf</li>
<li>位运算符</li>
<li>includes (ES7)</li>
</ol>
<h3 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h3><p><code>Array.prototype.indexOf</code>这个方法可能是我们用得最多的一个方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> one = arr.indexOf(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">const</span> four = arr.indexOf(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">const</span> isHasOne = one &gt; <span class="number">-1</span></span><br><span class="line"><span class="keyword">const</span> isHasFour = four &gt; <span class="number">-1</span></span><br><span class="line"><span class="built_in">console</span>.log(isHas) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(isHasFour) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>返回值得规则：<strong>指定值的第一次出现的索引; 如果没有找到 -1</strong>，所以判断是否有值即判断是否<strong>大于&gt;-1</strong>即可。</p>
<blockquote>
<p> 但是，indexOf不能判断NaN!</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'foo'</span>, <span class="number">123</span>, <span class="literal">true</span>, <span class="literal">undefined</span>, <span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>) <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
<p>这是以前JS规定，NaN!==NaN。但是数组里存在NaN元素，按理来说是相等的。所以就出现了后者的<code>includes</code>.</p>
<h3 id="（按位运算符）"><a href="#（按位运算符）" class="headerlink" title="~（按位运算符）"></a>~（按位运算符）</h3><p>有的人认为，<code>indexOf() &gt; -1</code>这种方法来判断不怎么美观，那有没有更快的方法？</p>
<p>那就是位运算符。</p>
<p><strong>按位非运算会把-1转换为0， 而在JS中，0可以被规范化为false</strong>。如果觉得返回的还是数字不直观，可以在前面加非运算符<code>!!</code>，转为Boolean值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">~arr.indexOf(<span class="number">1</span>) <span class="comment">// -1 =&gt; true</span></span><br><span class="line">~arr.indexOf(<span class="number">4</span>) <span class="comment">// 0 =&gt; false</span></span><br><span class="line">!!~arr.indexOf(<span class="number">1</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h3><p>ES7中引入了新的方法includes()，可以用来检测一个数组是否包含另外一个字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">1</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>而且，还修复了判断NaN的问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'foo'</span>, <span class="number">123</span>, <span class="literal">true</span>, <span class="literal">undefined</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>但是，新东西还是有兼容性。这仅在Chrome, Firefox, Safari 9+ 和 Edge中被支持， IE11- 都不支持。</p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/JS技巧/">JS技巧</a></li></ul></footer></article><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zNDU0Ni8xMTA4NA=="><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2018 hopkinson</div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-115092889-1');
ga('send','pageview');</script><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>